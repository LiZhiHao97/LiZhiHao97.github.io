---
title: 论文速读：TwoStreamVAN
date: 2020-12-25 11:13:07
index_img: https://img1.baidu.com/it/u=2357930729,2857529824&fm=253&fmt=auto&app=120&f=JPEG?w=650&h=367
categories:
 - 计算机视觉
tags:
  - 深度学习
  - 视频生成
  - GAN
---

## 1. Introduction

> 原文地址：[TwoStreamVAN: Improving Motion Modeling in Video Generation](https://openaccess.thecvf.com/content_WACV_2020/papers/Sun_TwoStreamVAN_Improving_Motion_Modeling_in_Video_Generation_WACV_2020_paper.pdf)

![](https://i.loli.net/2020/12/24/QuJrB95NZzkI42s.png)

像素级视频预测[27，36，40]和生成方法的一个主要问题是，它们试图在单个纠缠生成器中对静态内容和动态运动进行建模，而不管它们是否在潜在空间中解开运动和内容\

本文认为在解码阶段分离运动和内容建模是至关重要的。一方面，它消除了内容生成过程中的运动干扰，并产生了更好的内容结构。另一方面，单独的运动建模有助于在整个序列中一致地产生与动作相关的运动。

本文提出了一个新的**TwoStreamVAN**，它从一个动作标签和一个分离的噪声向量生成一个视频，如上x`图所示。通过两个并行的生成器，分别处理内容和运动，并将它们融合在一起以预测下一帧，而不是高估单个生成器的能力（如MoCoGAN的做法）。

直观地说，运动通常以其局部上下文窗口内的空间信息为条件，例如，在做跳跃动作时，手臂和腿部附近的不同运动。因此，我们将运动和内容的融合定义为对每个位置唯一的像素值的学习细化。为了精确地生成多尺度运动，我们在具有几个不同分辨率的中间内容层上进行这种细化。此外，我们还引入了运动蒙版，使运动聚焦于它所在的区域。

本文将引入**图像级监控（image-levelsupervision）**，虽然**MoCoGAN**尝试了图像级监控缺效果甚微，因为内容生成仍然受到单个共享生成器中运动建模的影响。本文使用的双流生成器的关键优势是能分别学习每个流，从而更准确。我们通过图像级监控完全了解其自身生成器中的图像结构，这显著提高了内容生成性能。训练有素的内容生成进一步有利于视频级监控中的动作学习。

本文贡献如下：

- 我们提出了一个视频生成模型TwoStreamVAN和一个更有效的学习方案，解决了生成阶段的运动和内容问题。
- 我们设计了一种多尺度运动融合机制，并通过对空间环境的调节进一步改进了运动建模
- 我们创建了一个大规模的合成视频生成数据集，供研究团体使用
- 我们在四个视频数据集上通过定量和定性分析评估了我们的模型（通过用户研究），并证明了强于几个强基线的结果。

## 2. Related Work

本文结合了**VAE**和**GAN**，提出了一个**变分对抗网络(VAN)**来学习一个可解释的潜在空间以及生成现实的图像。鉴于**VAN**在图像生成方面的成功，我们在此将其用于视频生成。

MoCoGAN试图通过从单独的潜在空间中采样来解开内容和运动，但是使用单个生成器来一起解码这两个潜在代码。为了克服统一生成过程中无效的运动建模和随之而来的内容恶化，我们进一步引入了分离的内容和运动生成器来分别对空间结构和时间动态进行建模。

## 3. Approach

我们引入了一个双流变分对抗网络(图2)，它生成一个给定输入动作标签和随机噪声向量的视频。我们定义动作条件视频生成如下。假设我们有**K**个不同的动作类。在每个类别**k ∈ 1: K** 的情况下，$$ C_{k} $$为该类别训练视频的数量。使$$ V_{k} $$ = {$$V_{i,k}, \forall i \in 1:C_{k}$$}为类别**k**视频的集合，$$v_{i,k}$$={$$ x_{1},x_{2},...,x_{T} $$}为一个T帧的短视频。任务是定义一个函数**G**，该函数根据来自潜在向量$$\epsilon$$ ∈ $$ ℝ^{N} $$，给定类别标签k，生成可信的视频$$\hat{v}$$，即$$ \hat{v} = G(k,\epsilon)$$

我们将潜在空间$$\epsilon$$分解成两个独立的代码:内容代码$$\epsilon_{c}$$∈ $$ ℝ^{C} $$和动作代码$$\epsilon_{m}$$∈$$ ℝ^{M} $$，N = C + M.我们还将视频生成函数**G**分解为两个独立的内容和运动函数($ G_{c} $和$ G_{m} $)，与以前使用单个生成器的工作形成对比，我们设计了一种新的多尺度融合机制。

![](https://i.loli.net/2020/12/24/XulgzWHeoixMRTb.png)

### 3.1 Two-Stream Generation

为了学习内容和运动建模的生成函数$ G_{c} $和$ G_{m} $，我们引入了两个独立的、在几个阶段具有交互作用的以动作为条件的VAN streams。每个steam包含一个**Encoder**，一个**Generator**和一个**Discriminator**，其中**Encoder**和**Generator**作为**VAE**的自动编码器，**Generator**和**Discriminator**组成了**GAN**

**Content VAN Stream**由内容编码器$ E_{c} $、内容生成器$ G_{c} $和图像鉴别器$ D_{I} $组成，在观察了**x**之后，生成了后验内容潜在分布$ q(z_{c}|x,k) $，这接近于它的真实先验分布$ p(z_{c}|k) $.$ G_{c} $将采样自内容分布的的内容向量$ \epsilon_{c} $解码成帧。$ D_{I} $鉴别帧的真假以鼓励$ G_{c} $生成更真实的图像。

类似地，**Motion VAN Stream**由运动编码器$ E_{m} $、运动生成器$ G_{m} $和视频鉴别器$ D_{V} $组成，在我们的方法中，$ E{m} $不是对空间内容进行编码，而是对相邻帧之间的差异图$ \triangle x $的时间动态进行编码。它产生的后验运动潜在分布$ q(z_{m}|\triangle x,k) $接近其真实的先验分布$ p(z_{m}|k) $.**convLSTM**对运动历史进行累积，并生成当前运动，嵌入$ e_{m} $，从所有先前时间步长的运动分布中接收$ \epsilon_{m} $序列。$ G_{m} $通过$ \epsilon_{c} $和$ e_{m} $在不同的尺度上产生运动。我们通过将生成的运动与**T**时间步长的相应内容融合来生成每个视频$ \hat{v} $。$ D_{V} $对真实/生成的视频进行了分类，并对他们的行为进行了分类，以鼓励$ G_{m} $生成逼真的动作

### Multi-scale Motion Generation and Fusion

在像素(a, b)处，运动通常发生在相邻帧之间的局部窗口内。受帧插值空间卷积的启发，我们将运动表示为当前像素值基础局部上下文的细化，并通过空间自适应卷积将这种运动与内容融合。此外，我们提出了一种新的多尺度融合机制来克服其方法的缺点，即:1)由于在全分辨率图像上执行单个融合步骤而导致的多尺度运动的无效建模，以及2)由于用于表示最大可能运动的大卷积核而导致的对存储器的高需求。

![](https://i.loli.net/2020/12/24/4NQFA9ECBtfpxza.png)

为了生成精确的运动，$ G_{m} $将解开的内容和运动嵌入($ \epsilon_{c} $和$ e_{m} $)作为输入。在$ G_{m} $中，不同尺度的运动将相应的隐藏层分开:大的运动来自低分辨率层，小的运动来自高分辨率层。在每一层，$ G_{m} $将当前特征映射为:1)以具有尺寸n的像素方式的2D核的形式计算运动(像素细化);2)识别运动遮罩中包含实际运动的区域；3)生成下一层的运动图。为了将运动与内容融合，仅当像素位于运动被激活的区域中时，我们才分别将生成的2D核与以相应像素为中心的面片进行卷积(即，执行空间自适应卷积)(参见上图)。



具体来说，假设我们把运动分成**S**个尺度。对于每个尺度的**s**，让$ l_{s} $为相对应的分辨率隐藏层，$ w^{s} ∈ ℝ^{l_{s}×l_{s}×n^{2}} $为$ G_{m} $产生的卷积核，$ h_{c}^{s} ∈ ℝ^{l_{s} × l_{s} × d_{s}} $为相对应的内容层，其中$ d_{s} $是内容特征维度。我们在以下步骤中执行空间自适应卷积。首先，对于每个位置(a,b)，我们从展开形式$ w^{s}(a,b) $恢复一个2D卷积核$ K^{s}(a,b) $.然后，我们将$ K^{s}(a,b) $与在$ h_{c}^{s} $的补丁$ P^{s}(a,b) ∈ ℝ^{n×n×d_{s}} $做卷积运算来生成一个位置(a,b)中间内容表示 $ \tilde{h}_{c}^{s}(a,b) $:

![image-20201225105952830](https://i.loli.net/2020/12/25/F4I7zgub9ahVnft.png)

我们通过向较小的层添加自适应卷积来处理较大的运动，而[29]则通过增加核大小来处理较大的运动。由于要存储和建模的参数数量在核大小中是平方的，因此在我们的多尺度融合框架中，我们通过对所有层利用小核(푛=3或5)来显著降低内存使用量和模型复杂度



为了$ G_{m} $的注意力集中学习尺度**s**在实际发生的区域的运动上，我们预测了一个带有$ w^{s} $的运动遮罩$ M^{s} ∈ ℝ^{l_{s}×l_{s}} $，以识别这样的区域。每个$ M^{s} $的的值都在[0，1]中。我们在$ M^{s}(a,b) $:的指导下通过融合运动从$ h_{c}^{s}(a,b) $和 $ \tilde{h}_{c}^{s}(a,b) $生成了新的内容$ \hat{h}_{c}^{s} $：

![image-20201225110922089](https://i.loli.net/2020/12/25/NLE6c9F4XHe2CaY.png)

## Conclusion

以上。